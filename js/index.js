/** * Created by miss on 2018-01-17. *///顶部window.onload=function(){    var oAbc=document.querySelector('.abc');    var oLink=document.querySelector('.news-link');    oAbc.onmouseover=function(){        oLink.style.display='block';        oAbc.style.opacity='0'    }    oAbc.onmouseout=function(){        oLink.style.display='none';        oAbc.style.opacity='1'    }    oLink.onmouseover=function(){        oLink.style.display='block';        oAbc.style.opacity='0'    }    oLink.onmouseout=function(){        oLink.style.display='none';        oAbc.style.opacity='1'    }    //导航开始    var topBar=document.querySelector('.topBar');    var oNav=document.querySelector('.nav_wrap');    function scroll() {        return {            top: window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop||0,            left: window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft||0        };    }    //内容开始    var roll=document.querySelector('.roll');    var rollImg=document.querySelector('.roll>img');    var goTop=document.getElementById('goTop');    var goBot=document.getElementById('goBot');    //运动的的距离    var dist=0;    var timer1=null;    goBot.onmouseover=function(){        clearInterval(timer1);        timer1=setInterval(function(){            dist--;            if(dist>-170){                rollImg.style.top=dist+"px";            }else{                clearInterval(timer1);            }        },5)    }    goTop.onmouseover=function(){        clearInterval(timer1);        timer1=setInterval(function(){            dist++;            if(dist<=0){                rollImg.style.top=dist+"px";            }else{                clearInterval(timer1);            }        },5)    }    roll.onmouseout=function(){        clearInterval(timer1);    }    //正则    var email=document.querySelector('.email>input');    var pass=document.querySelector('.pass>input');    var holder=document.querySelector('.test');    email.addEventListener('blur',function(){        if(this.value===""){            return;        }        var userEm = /\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/;        if(userEm.test(email.value)){            holder.innerHTML="　";        }else{            holder.innerHTML="请重新输入";        }    })    pass.addEventListener('blur',function(){        if(this.value===""){            return;        }        var userP = /^[0-9A-Za-z]{6,16}$/;        if(userP.test(pass.value)){            holder.innerHTML="　";        }else{            holder.innerHTML="请重新输入";        }    })//选项卡    var top=document.querySelectorAll('.top');    var topCon=document.querySelectorAll('.top_con');    tabs(top,topCon);    function tabs(click,box){        for(var i=0;i<click.length;i++){            click[i].index=i;            click[i].onclick=function(){                for(var i=0;i<box.length;i++){                    box[i].style.display="none";                }                box[this.index].style.display="block";            }        }    }//轮播图    var box=document.querySelector('.game_all');    var screen = document.querySelector('.game_wrap');    var ul = screen.children[0];    var ulLis = ul.getElementsByTagName("li");    var ol = document.querySelector('.game_nav ol');    var arr = document.getElementById("arr");    var left = document.getElementById("left");    var right = document.getElementById("right");    var imgWidth = screen.offsetWidth;    var timer = null;    var olLis = ol.children;    olLis[0].className = "on";    var firstImg = ulLis[0].cloneNode(true);    ul.appendChild(firstImg);    var target = 0;    for (var i = 0; i < olLis.length; i++) {        olLis[i].index = i;        olLis[i].onmouseover = function () {            for (var j = 0; j < olLis.length; j++) {                olLis[j].className = "";            }            this.className = "on";            target = -this.index * imgWidth;            animate(ul, 30, target);            pic = square = this.index;        };    }    box.onmouseover = function () {        arr.style.display = "block";        clearInterval(timer);    };    box.onmouseout = function () {        arr.style.display = "none";        timer = setInterval(playNext, 3000);    };    var pic = 0;//记录当前显示的图片的索引    var square = 0;//记录当前亮起的按钮的索引    right.onclick = function () {//        alert(ulLis.length)        if (pic === ulLis.length - 1) {//最后一张图片的索引            ul.style.left = 0;//瞬间移动到开头            pic = 0;//索引归0，后续的代码会让ul渐渐地从第一张图片移动到第二张图片        }        pic++;//计算出接下来应该显示的图片的索引        target = -pic * imgWidth;        animate(ul, 30, target);        if (square < olLis.length - 1) {//还没到最后            square++;//计算出下一个应该亮起的按钮的索引        } else {            square = 0;        }        for (var i = 0; i < olLis.length; i++) {            olLis[i].className = "";        }        olLis[square].className = "on";    };    left.onclick = function () {        if (pic === 0) {//第一张图            ul.style.left = -(ulLis.length - 1) * imgWidth + "px";//瞬间移动到最后            pic = ulLis.length - 1;        }        pic--;//计算出接下来应该显示的图片的索引        target = -pic * imgWidth;        animate(ul, 30, target);        if (square > 0) {//还没到最前            square--;//计算出下一个应该亮起的按钮的索引        } else {            square = olLis.length - 1;        }        for (var i = 0; i < olLis.length; i++) {            olLis[i].className = "";        }        olLis[square].className = "on";    };    //添加自动滚动    timer = setInterval(playNext, 3000);//每隔一秒钟播放下一张    function playNext() {        right.onclick();    }    function animate(ele,step,target){        clearInterval(ele.timer);        ele.timer=setInterval(function(){            var leader=ele.offsetLeft;            step=Math.abs(step);            step=leader<target?step:-step;            if(Math.abs(target-leader)>=Math.abs(step)){                leader+=step;                ele.style.left=leader+"px";            }else{                ele.style.left=target+"px";                clearInterval(ele.timer)            }        },10)    }//自动吸附    var oDiv=document.querySelector('.tz_box');    var tbBox=document.querySelector('.tb_box');    oDiv.onmousedown=function(ev){        var oEvent=ev||event;        var x=oEvent.clientX-oDiv.offsetLeft;        var y=oEvent.clientY-oDiv.offsetTop;        document.onmousemove=function(ev){            var oEvent=window.event||ev;            var left=oEvent.clientX-x;            var top=oEvent.clientY-y;            if(left<60){                left=0            }            if(tbBox.offsetWidth-oDiv.offsetWidth-left<60){                left=tbBox.offsetWidth-oDiv.offsetWidth            }            if(top<60){                top=0;            }            if(top>tbBox.offsetHeight-oDiv.offsetHeight-60){                top=tbBox.offsetHeight-oDiv.offsetHeight            }            oDiv.style.left=left+"px";            oDiv.style.top=top+"px"        }        document.onmouseup=function(){            document.onmousemove=null;        }    }    //模态框    var ling=document.querySelector('.lq_btn');    var mask=document.querySelector('.mask');    var gift=document.querySelector('.gift');    var close=document.querySelector('.close')    ling.onclick=function(){        mask.style.display="block";        gift.style.display="block";    }    close.onclick=function(){        mask.style.display="none";        gift.style.display="none";    }//返回顶部    var backTop=document.querySelector('.backtop')    var back= 0,juli=0;    if(scroll().top>1000){        backTop.style.opacity="1"    }else{        backTop.style.opacity="0"    }    window.onscroll=function(){        if(scroll().top>1000){            backTop.style.opacity="1"        }else{            backTop.style.opacity="0"        }        back=scroll().top;        if(scroll().top>topBar.offsetHeight){            oNav.className="fixed";        }else{            oNav.className="nav_wrap";        }    };    backTop.onclick=function(){        clearInterval(timer);        timer=setInterval(function(){            var step=(juli-back)/10;            step=step>0?Math.ceil(step):Math.floor(step);            back=back+step;            window.scrollTo(0,back);            if(juli===back){                clearInterval(timer)            }        },15)    };    //动态获取    var oBtn = document.querySelector('.two a');    oBtn.onclick = function() {        var xhr = null;        try {            xhr = new XMLHttpRequest();        } catch (e) {            xhr = new ActiveXObject('Microsoft.XMLHTTP');        }        xhr.open('get','links/getNews.php',true);        xhr.send();        xhr.onreadystatechange = function() {            if ( xhr.readyState == 4 ) {                if ( xhr.status == 200 ) {                    var data = JSON.parse( xhr.responseText );                    var oUl = document.getElementById('content');                    var html = '';                    for (var i=0; i<data.length; i++) {                        html += '<li><p>'+data[i].title+'</p><span>'+data[i].date+'</span></li>';                    }                    oUl.innerHTML = html;                } else {                    alert('出错了,Err：' + xhr.status);                }            }        }    }}